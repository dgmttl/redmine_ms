<?xml version="1.0" encoding="UTF-8"?>
<hash>
  <before-save nil="true"/>
  <after-save nil="true"/>
  <name>GERCONT_methods</name>
  <description></description>
  <is-for-all type="boolean">false</is-for-all>
  <author>diogo.neiva@saude.gov.br</author>
  <active type="boolean">true</active>
  <shared-code>
def requested_versions_was
    @issue.custom_field_values.detect { |v| v.custom_field_id == @field_for_requested_versions }.value_was
end

def requested_versions_is
    @issue.custom_field_values.detect { |v| v.custom_field_id == @field_for_requested_versions }.value
end

def requested_versions_changed?
    requested_versions_was != requested_versions_is
end

 
def stories_by_version_ids(version_ids)
    versions = Version.where(id: version_ids.map(&amp;:to_i))
    puts "==================== stories_by_version_ids - versions: #{versions}"
    story_ids = versions.map do |v|
        v.fixed_issue_ids
    end.flatten

    puts "==================== stories_by_version_ids - story_ids: #{story_ids}"

    Issue.where(id: story_ids)
end

def create_demand_backlog

    puts "======================== @issue: #{@issue}"
    name = @issue.to_s.split(':')[0]
    puts "======================== nome: #{name}"
    puts "======================== description: [#{l(:label_view)} #{@issue.to_s.split(':')[0]}](/issues/#{@issue.id})"
    demand_backlog = Sprint.create(
        name: name,
        description: "[#{l(:label_view)} #{@issue.to_s.split(':')[0]}](/issues/#{@issue.id})",
        # description: "[#{l(:label_view)} #{name}](/issues/#{@issue.id})",
        status: 'open',
        shared: '0',
        is_product_backlog: 'true',
        project: @issue.project,
        sprint_start_date: Date.today,
        sprint_end_date: Date.today,
        user: User.current
    )
    puts "================== create_demand_backlog - @demand_backlog: #{demand_backlog}"
   
    demand_backlog
  end

</shared-code>
  <before-add nil="true"/>
  <after-add nil="true"/>
  <before-remove nil="true"/>
  <after-remove nil="true"/>
  <before-destroy nil="true"/>
  <after-destroy nil="true"/>
  <observable>shared</observable>
  <id type="integer">4</id>
  <created-at type="dateTime">2025-04-13T17:13:53Z</created-at>
  <updated-at type="dateTime">2025-04-17T19:33:21Z</updated-at>
  <string></string>
  <position type="integer">2</position>
  <integer type="integer">1</integer>
  <exported-at>2025-04-17T20:07:57Z</exported-at>
  <plugin-version>3.0.0</plugin-version>
  <ruby-version>3.3.7-p123</ruby-version>
  <rails-version>7.2.2.1</rails-version>
</hash>